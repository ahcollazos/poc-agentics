# Documentación: Modificación de Lambda de Consulta de Servicios Públicos
 
## Descripción
 
### Título
Modificar Lambda de Consulta de Servicios Públicos para Consumir API y Persistir Items de Pago
 
### Descripción
Este requerimiento técnico busca modificar la Lambda de consulta de servicios públicos para integrar el servicio `/paymentsManagement/v3/Administration_Billers/Billers`. La Lambda debe tomar el tipo y número de documento del cliente como parámetros, invocar el servicio para obtener el listado de servicios inscritos y, posteriormente, persistir la información en la tabla DynamoDB `payment-item-client`. Es crucial que la Lambda resuma la información consultada y genere un objeto para la columna Card antes de la persistencia.
 
---
 
## Criterios de Aceptación
 
### Consumo de Servicio
- [ ] La Lambda de consulta de servicios públicos se ha modificado para consumir el servicio `/paymentsManagement/v3/Administration_Billers/Billers`
- [ ] La Lambda envía el tipo y número de documento del cliente como parámetros de la solicitud
 
### Formateo y Mapeo
- [ ] La Lambda procesa la respuesta del servicio externo
- [ ] La información se resume y se formatea según el archivo adjunto
- [ ] Se genera un objeto específico para la columna Card que contiene solo la información relevante para el frontend
 
### Persistencia de Datos
- [ ] La Lambda persiste la información formateada en la tabla `payment-item-client`
- [ ] La persistencia incluye el UUID, el Client, la Data y el objeto Card
 
### Pruebas y Documentación
- [ ] Se han creado pruebas de integración para validar el consumo del servicio externo y la correcta persistencia de la información en DynamoDB
- [ ] La documentación de la Lambda se ha actualizado para reflejar la nueva lógica, el mapeo de campos y la estructura de la información persistida
 
---
 
## Detalles Técnicos
 
| Componente | Descripción |
|------------|-------------|
| **Componente** | Lambda de consulta de servicios públicos |
| **Servicio Externo** | GET `/paymentsManagement/v3/Administration_Billers/Billers` |
| **Base de Datos** | Tabla `payment-item-client` en DynamoDB |
| **Lógica de Resumen** | La Lambda debe implementar una lógica de negocio para resumir la información del servicio de consulta y crear el objeto de la columna Card con la información mínima y necesaria |
| **Persistencia** | La Lambda debe utilizar una operación de PutItem en DynamoDB para persistir el nuevo ítem en la tabla |
 
---
 
## Dependencias
 
- [ ] Acceso a la documentación del servicio `/paymentsManagement/v3/Administration_Billers/Billers`
- [ ] La tabla `payment-item-client` debe estar creada con la estructura necesaria
- [ ] Credenciales para la conexión y consulta al servicio externo
- [ ] Permisos IAM para la Lambda de lectura y escritura en la tabla `payment-item-client`
 
---
 
## Notas Importantes
 
- [ ] Validar la creación del TTL
- [ ] Validar la versión del servicio a consumir
- [ ] Validar el tipo de autenticación del servicio a consumir
 
---
 
## Checklist de Implementación
 
### Fase de Desarrollo
- [ ] Modificar código de la Lambda para consumo del servicio externo
- [ ] Implementar lógica de resumen y formateo de datos
- [ ] Crear objeto Card para frontend
- [ ] Implementar persistencia en DynamoDB
- [ ] Configurar manejo de errores
 
### Fase de Testing
- [ ] Pruebas unitarias de lógica de resumen
- [ ] Pruebas de integración con servicio externo
- [ ] Pruebas de persistencia en DynamoDB
- [ ] Pruebas de rendimiento
 
### Fase de Despliegue
- [ ] Actualizar políticas IAM
- [ ] Configurar variables de entorno
- [ ] Actualizar documentación técnica
- [ ] Validar funcionamiento en entorno de producción
 
---
 
## Estructura Esperada en DynamoDB
 
| Campo | Tipo | Descripción |
|-------|------|-------------|
| UUID | String | Identificador único del registro |
| Client | String | Información del cliente (documento) |
| Data | Array | Datos completos de servicios consultados |
| Card | Object | Objeto resumido para visualización en frontend |
| TTL | Number | Tiempo de expiración del registro |
 
---
 
## Responsables
 
- **Desarrollo:** Equipo de Backend
- **Testing:** Equipo de Calidad
- **Despliegue:** DevOps/Infraestructura
- **Validación:** Product Owner