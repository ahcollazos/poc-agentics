# Implementar Lógica de Persistencia en Lambda `payment-schedule-config` para Guardar Configuración de Pagos

## Descripción

Este requerimiento técnico consiste en implementar la lógica de persistencia en la función Lambda `payment-schedule-config`. La Lambda debe ser capaz de recibir un objeto JSON con la estructura detallada en el archivo adjunto, que representa una configuración de programación de pagos. El objetivo es que la Lambda extraiga la información del JSON y la persista en la tabla de DynamoDB `payment-schedule-data`, cuya estructura está definida en la imagen adjunta. Esta lógica debe manejar tanto la creación inicial como la actualización de los registros.

---

## Criterios de Aceptación

### Mapeo de Datos

- La Lambda `payment-schedule-config` recibe el objeto JSON de entrada.
- La Lambda extrae y mapea la información del objeto de entrada a la estructura de la tabla de DynamoDB `payment-schedule-data`.
- El `scheduleId` del JSON de entrada se mapea a la clave de partición `UUID` de la tabla.
- La información del cliente (cabeceras `X-CustIdentType`, `X-CustIdentNum`) se mapea al campo `Client`.
- La información de la programación estándar (`invoiceInfo`, `paymentAccounts`, `maxAmount`, `minAmount`, `scheduleOptions`) se mapea al campo `standard settings`.
- La información de la programación personalizada (`validity`, `notifications`) se mapea al campo `custom settings`.
- El estado inicial de la programación se mapea a `Process`.

### Lógica de Persistencia en DynamoDB

- Si la Lambda recibe un `scheduleId` que no existe en la tabla, se crea un nuevo registro (ítem).
- Si la Lambda recibe un `scheduleId` que ya existe, se actualiza el registro existente, sobrescribiendo los datos de la programación estándar o personalizada con la nueva información.
- La Lambda debe ser capaz de manejar la actualización de campos individuales, permitiendo la persistencia parcial de la información en diferentes momentos.

### Manejo de Respuestas

- La Lambda retorna un código de estado de éxito (ej., 200 OK) si la persistencia es exitosa.
- En caso de error, retorna un código de error y un mensaje descriptivo.

### Pruebas y Documentación

- Se han creado pruebas unitarias y de integración que validan el mapeo y la persistencia de datos, incluyendo la creación de nuevos registros y la actualización de registros existentes.
- Se ha actualizado la documentación en Confluence para reflejar la lógica de persistencia de la Lambda y el mapeo del objeto JSON a la tabla de DynamoDB.

---

## Detalles Técnicos

- **Componentes:** AWS Lambda `payment-schedule-config`, Amazon DynamoDB `payment-schedule-data`.
- **Operaciones DynamoDB:** Se utilizará la operación `PutItem` para la creación y sobrescritura de registros, y potencialmente `UpdateItem` para actualizaciones más específicas si se requiere.
- **Lógica de Mapeo:** Se debe crear un objeto de mapeo o una clase que represente la estructura de la tabla de DynamoDB y que tome el JSON de entrada como base para poblar sus campos.

### Dependencias

- La tabla de DynamoDB `payment-schedule-data` debe estar creada.
- Las credenciales de acceso para la Lambda deben estar configuradas para permitir la escritura en la tabla.
- La especificación completa del objeto JSON de entrada debe ser accesible para el desarrollador.

---

## Consideraciones

- Existen programaciones que se crean en la banca personal, estas no tienen la información para la columna `custom settings`, por lo tanto estas columnas quedan vacías. Los servicios que tienen como fuente estas columnas deben estar en la capacidad de manejar la entrada `null` sin generar error.
- Se requiere un mecanismo de sincronización (fuera del alcance de esta historia) para las programaciones que se crean por la Banca Personal, para sincronizar la creación, edición y eliminación de programaciones.
- Recordar que el `UUID` es el PK de la tabla y como viene del frontend y se requiere enviar al servicio de SC este tiene que ser numérico, no debe tener caracteres.